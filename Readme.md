
     本文档为markdown格式，请用mou等工具打开，内容在分屏右侧
 
 
 >俺是一名本科大三在校生，从大三开始纯自学iOS。大学期间，平时大多编写纯native程序（本地/socket交互），了解基本的js/html语法，可以看懂，但对于混合开发比较陌生，并没有实际接手开发过WebApp。**了解到这个题目并不简单，虽然颇有些压力，但是遇到难题必须想办法克服，所以我对本次的题目进行了大量的相关学习，从6.7正式开始项目攻关。**
 
 
 
 
 
# p.s. 
##概况
*  俺在6月6日黄昏收到面试题邮件，次日正式开始项目。


*  因为本人为在校生，在校期间依然有课，所以本项目只能在本时间段内的课余时间进行。

##关于兼容性和稳定性
* 本程序可以兼容至iOS7.因为runtime的变化，os x El Capitan不能运行iOS7模拟器不能实际调试，但是理论上兼容iOS7没有任何问题。



* 本程序经过稳定性检查，没有发生过崩溃的现象，内存占用基本维持在50-60m左右，不会造成后台的负担。


##关于warning
*  关于本项目中的warning：本项目考虑到兼容性问题，会出现一些warning。


1. warning原因1：为了兼容iOS7，故没有使用WKWebView进行开发，但是使用了第三方框架IMYWebView，得以在UIWebView和WKWebView之间无缝切换，而且为了JS和OC的交互，使用了第三方框架WebViewJavascriptBridge，其中bridge框架并未加入对IMYWebView的原生支持(IMYWebView本质依旧是UIWebView和WKWebView)。



2. warning原因2:使用AVCaptureSession制作了自定义相机，基于苹果官方demo修改而成。为了兼容iOS7，故没有使用最新的方法，严格按照demo中最稳定的，支持iOS7的方法开发了拍摄模块。
3. 综述以上两点，**本程序中的所有这些warning是兼容iOS7的结果，不会对本项目的功能造成实质性影响。**

 
 
 

项目进度



#2016.6.7 第一天
 
##组织思路:

 
###本地部分：
 
 * 使用WKWebView
 * 使用AGSimpleImageEditorView对照片/图片进行裁剪/缩放
 * 使用AVCaptureSession编写自定义相机UI
 
 
 
 
###JS&HTML部分：
 
 * 使用BootStrap栅格系统做移动端的屏幕适配/一些自定义效果
 * 利用alert或其他系统函数与iOS进行交互/传参
 * 利用JavaScript来控制图片格式
 
##代码：
* 做了一个项目UI的native版本
* 搭建了粗糙的html框架
* 测试了WKWebView等控件并加深熟悉使用

#2016.6.8 第二天
##完成了自定义相机和剪裁：

* 利用AVCaptureSession，参考了官方demo，精简，打磨，适应代码，实现了自定义相机。



* 根据以往的经验，自定义了GNEditViewController，利用手势识别来实现移动图像，利用Quarz2D实现了图片的剪裁，最终实现了图片剪裁功能。



* 总结：今日共完成照相和剪裁模块。





#2016.6.9 第三天

##完成了所有本地控制器：
* 考虑到其效率更高，使用更方便，想到利用WKWebView，但项目要求支持iOS7.0以上，故再次考虑使用UIWebView，查询各种资料得知，github有一框架，可以实现WK和UI双Webview的无缝切换，最终使用该第三方框架，使本程序同时获得了兼容性和性能。

* 基于以前的草图，开始将HTML重构，重建界面，开始考虑到接口部分。



* 整合所有控制器模块，完成了各个控制器之间的跳转。


##发现了新的难题：
* 使用evaluate方法可以在native端运行JS代码，但修改网页上的图片并不容易，每次选好或者更改了图片回到WebView的时候，图片的刷新成了问题。



* WKWebView在WebView中使用messageHandler回调OC方法稍微简易，但考虑到兼容性，必须使用UIWebView来做OC回调，如果要保持强兼容性，又需要加入新的第三方框架:WebViewJavascriptBridge，代码复杂程度增加。

#2016.6.10 第四天
##开始搭桥：
了解了桥的使用，完成了oc的native之间沟通的代码，本日程序除接口部分以外已经全部完成。试图完成js接口，但是遇到了新的问题。

##遇到了新的问题：
1.使用WebViewJavaScriptBrigde，就不能使用UIWebView的delegate。所以在使用框架的方法重新设置delegate之前，didFinishLoading方法不会被调用。

2.解决了问题1之后，发现在重新加载html的时候修改src无效，remove却有效，本问题暂时无解。


3.html并未使用外来库，甚至连内置图片都使用了其base64嵌入到html中，但是下拉框竟然无法拉下。经过各种检查，依然无法解决。



#2016.6.11 第五天
##搭桥成功
* 在此iOS部分代码功能以及接口已经全部实现。
* 在iOS端搭桥完成之后，修改js的handler，也成功让js成功接收来自objC的消息。。



##修改html，修复部分问题
* 因为下拉框无法使用，而且重复检查代码没有任何问题，(本html并没有使用外链库，纯原生实现，也不会是库的问题)但是严重影响了功能的实现，所以干脆取消下拉框，使用纯按钮解决问题。最终webView已经可以顺利实现界面跳转，而且可以顺利传值进编辑界面，可以成功按需切图。



* 进一步完善html中的逻辑，包括各种输入错误，逻辑方面，现阶段html已经基本不可能出现用户误操作导致崩溃的情况，足够健壮。







#2016.6.12 
（学校收假满课，没有进行开发）

#2016.6.13
##本程序开发完成
检查了代码，进行了简单整理，并发回您处。



##**感谢您的阅读，诚希望能与您共事！**








 
